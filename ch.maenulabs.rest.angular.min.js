/**
 * ch.maenulabs.rest.angular v0.3.0
 * built on 15.08.2015
 * Copyright 2015 Manuel Leuenberger
 * licenced under MIT, see LICENSE.txt
 */
angular.module("ch.maenulabs.rest.angular",["ch.maenulabs.rest.angular.resource"]),angular.module("ch.maenulabs.rest.angular.resource",[]),angular.module("ch.maenulabs.rest.angular.resource").factory("ch.maenulabs.rest.angular.resource.AbstractResource",["$http",function(r){var i=function(r){var t={};for(var e in r)if(r.hasOwnProperty(e)){var n=r[e];if(n instanceof Object){n=i(n);for(var a in n)n.hasOwnProperty(a)&&(t[e+"."+a]=n[a])}else t[e]=n}return t},t=ch.maenulabs.validation.Validation;return new ch.maenulabs.type.Type(Object,{initialize:function(r){angular.extend(this,r||{}),this.validation=this.validation||new t},hasErrors:function(){return this.validation.hasErrors(this)},getErrors:function(){return this.validation.getErrors(this)},hasError:function(r){var i=this.validation.getErrors(this);return i[r]&&i[r].length>0},getError:function(r){return this.validation.getErrors(this)[r]||[]},create:function(){return r({url:this.getBaseUri(),method:"POST",data:this.serialize()}).success(angular.bind(this,function(r,i,t){this.uri=t("location")}))},read:function(){return r({url:this.uri,method:"GET"}).success(angular.bind(this,function(r){this.deserialize(r)}))},update:function(){return r({url:this.uri,method:"PUT",data:this.serialize()})},remove:function(){r({url:this.uri,method:"DELETE"}).success(angular.bind(this,function(){this.uri=null}))},search:function(){var i=r({url:this.getSearchUri(),method:"GET"});return i.results=[],i.success(angular.bind(this,function(r){for(var t=angular.fromJson(r),e=0;t.length>e;e+=1)i.results.push(this.type.desimplify(t[e]))}))},serialize:function(){return angular.toJson(this.simplify())},deserialize:function(r){this.desimplify(angular.fromJson(r))},simplify:function(){return{uri:this.uri}},desimplify:function(r){this.uri=r.uri},getBaseUri:function(){throw Error("not implemented")},getSearchUri:function(){return this.getBaseUri()+"?"+this.toSearchParameters()},toSearchParameters:function(){var r=[],t=i(this.simplify());for(var e in t){var n=encodeURIComponent(e)+"="+encodeURIComponent(t[e]);r.push(n)}return r.join("&")}},{deserialize:function(r){var i=new this;return i.deserialize(r),i},desimplify:function(r){var i=new this;return i.desimplify(r),i}})}]);